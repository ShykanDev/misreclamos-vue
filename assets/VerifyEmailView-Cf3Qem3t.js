import{d as U,g as t,s as N,m as q,h as A,i as L,o as d,w as E,c as m,a as r,n as b,t as p,x,b as j,e as z,r as I,l as C,v as P,k as S,u as $}from"./index-CFQCWbJI.js";import{g as D,_ as T,e as G,v as Z,f as F}from"./MainLayout.vue_vue_type_script_setup_true_lang-BupE7rrv.js";import{L as H}from"./LoaderA-BsqvABUU.js";import{N as J}from"./notyf.min-DBCpgn8f.js";const K={key:1,class:"flex flex-col justify-center items-center p-6 mx-auto space-y-6 min-h-screen bg-gradient-to-br from-indigo-50 to-pink-50"},Q={class:"p-8 space-y-6 w-full max-w-md bg-white rounded-3xl shadow-xl transition-all duration-300 hover:shadow-2xl"},W={class:"text-3xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-purple-600"},X={key:0,class:"p-4 text-center text-green-700 bg-green-50 rounded-xl animate-fade-down"},Y={class:"font-medium"},ee={key:1,class:"p-4 text-center text-red-700 bg-red-50 rounded-xl animate-fade-up"},re={class:"font-medium"},oe={key:2,class:"flex fixed inset-0 justify-center items-center px-4 bg-gradient-to-br from-rose-100 via-pink-50 to-white"},ae={class:"w-full max-w-md"},se={class:"p-8 bg-white rounded-2xl shadow-xl"},te={class:"space-y-4"},ce=U({__name:"VerifyEmailView",setup(ne){const o=new J({position:{x:"center",y:"top"},duration:5e3,dismissible:!0}),a=t(!1),h=N(),s=h.query.mode,c=h.query.oobCode,w=D(),k=t(!1),R=t(!1),g=t(!1),l=t(!1),i=t(""),_=$(),B=async()=>{if(s!=="verifyEmail")throw l.value=!0,i.value='Invalid URL "Mode" parameter is not a valid value, does the URL have a valid "Mode" parameter?',new Error('URL has not a valid "Mode" parameter');if(!c)throw l.value=!0,i.value='Invalid URL "OOB" parameter is not a valid value, does the URL have a valid "OOB" parameter?',new Error('URL has not a valid "OOB" parameter');try{a.value=!0,await G(w,c),s==="verifyEmail"&&(k.value=!0),a.value=!1}catch(u){const e=u;console.log(e),l.value=!0,a.value=!1,i.value=e.code}};q({length:!1,uppercase:!1});const n=t(),f=t(),v=t(!1),M=async()=>{try{const u=await Z(w,c);return v.value=!0,!0}catch(u){const e=u;return o.error(`El código de verificación no es válido: ${e.message}`),console.log(e),l.value=!0,a.value=!1,i.value=e.message,v.value=!1,!1}},V=async()=>{if(!n.value){o.error("Por favor ingrese su nueva contraseña");return}if(n.value.length<8){o.error("La contraseña debe tener al menos 8 caracteres");return}if(!/[A-Z]/.test(n.value)){o.error("La contraseña debe tener al menos una letra mayúscula");return}if(n.value!==f.value){o.error("Las contraseñas no coinciden");return}if(!v.value){o.error("El código de verificación no es válido");return}try{a.value=!0,await F(w,c,n.value),R.value=!0,g.value=!0,n.value="",f.value="",o.success("Contraseña actualizada correctamente, redirigiendo a iniciar sesión..."),_.push("/login"),a.value=!1}catch(u){const e=u;o.error(`Error al actualizar la contraseña: ${e.message}`),console.log(e),l.value=!0,a.value=!1,v.value=!1,g.value=!1,i.value=e.message}};return A(()=>{if(!s||!c){o.error('URL has not a valid "Mode" or "OOB" parameter'),l.value=!0,a.value=!1,i.value='URL has not a valid "Mode" or "OOB" parameter';return}s==="verifyEmail"?B():s==="resetPassword"&&M()}),(u,e)=>{const O=I("RouterLink");return d(),L(T,null,{main:E(()=>[a.value?(d(),L(H,{key:0,class:"flex fixed inset-0 z-40 justify-center items-center bg-black/50"})):(d(),m("div",K,[r("div",Q,[r("h1",W," Verificar "+p(x(s)==="verifyEmail"?"correo":"contraseña"),1),k.value?(d(),m("div",X,[e[3]||(e[3]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto mb-2 w-8 h-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),r("p",Y," ¡"+p(x(s)==="verifyEmail"?"Correo":"Contraseña")+" verificado con éxito! ",1),e[4]||(e[4]=r("p",{class:"mt-2 text-sm"},"Ahora puede iniciar sesión con su correo y contraseña.",-1)),e[5]||(e[5]=r("p",null,"¡Bienvenido a misreclamos.com!",-1)),j(O,{to:{name:"login"},class:"inline-flex items-center px-4 py-2 mt-4 text-white bg-indigo-600 rounded-lg transition-colors duration-200 hover:bg-indigo-700"},{default:E(()=>[...e[2]||(e[2]=[z(" Iniciar sesión",-1)])]),_:1})])):b("",!0),l.value||!v.value?(d(),m("div",ee,[e[6]||(e[6]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto mb-2 w-8 h-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),r("p",re," Error al verificar el "+p(x(s)==="verifyEmail"?"correo":"contraseña")+", código de error: "+p(i.value),1),e[7]||(e[7]=r("p",{class:"mt-2 text-sm"}," Por favor, verifique que los parámetros del enlace sean correctos. ",-1))])):b("",!0),x(s)==="resetPassword"&&!g.value?(d(),m("section",oe,[r("div",ae,[r("div",se,[e[10]||(e[10]=r("h2",{class:"mb-2 text-2xl font-bold text-center text-rose-600"}," Actualizar contraseña ",-1)),e[11]||(e[11]=r("p",{class:"mb-6 text-center text-gray-500"},"Por favor ingrese su nueva contraseña",-1)),r("form",te,[r("div",null,[e[8]||(e[8]=r("label",{for:"password",class:"block mb-1 text-sm font-medium text-gray-700"}," Nueva contraseña ",-1)),C(r("input",{"onUpdate:modelValue":e[0]||(e[0]=y=>n.value=y),type:"password",id:"password",class:"px-4 py-2 w-full rounded-xl border border-gray-300 transition focus:ring-2 focus:ring-rose-400 focus:border-rose-400",placeholder:"••••••••",required:""},null,512),[[P,n.value]])]),r("div",null,[e[9]||(e[9]=r("label",{for:"confirmPassword",class:"block mb-1 text-sm font-medium text-gray-700"}," Confirmar contraseña ",-1)),C(r("input",{"onUpdate:modelValue":e[1]||(e[1]=y=>f.value=y),type:"password",id:"confirmPassword",class:"px-4 py-2 w-full rounded-xl border border-gray-300 transition focus:ring-2 focus:ring-rose-400 focus:border-rose-400",placeholder:"••••••••",required:""},null,512),[[P,f.value]])]),r("button",{type:"submit",onClick:S(V,["prevent"]),class:"py-2.5 w-full font-semibold text-white bg-rose-500 rounded-xl shadow-md transition transform hover:bg-rose-600 hover:-translate-y-0.5"}," Guardar nueva contraseña ")])])])])):b("",!0)])]))]),_:1})}}});export{ce as default};
