import{d as N,g as t,y as j,s as q,i as A,k,o as d,w as L,c as p,a as r,j as E,t as x,z as w,b as z,e as I,r as S,p as C,v as P,m as D,x as T}from"./index-D-NrbOI-.js";import{g as $,_ as G,e as R,f as Z}from"./MainLayout.vue_vue_type_script_setup_true_lang-0UTQqhQh.js";import{L as F}from"./LoaderA-Cn7pnTr8.js";import{N as H}from"./notyf.min-DBCpgn8f.js";const J={key:1,class:"flex flex-col justify-center items-center p-6 mx-auto space-y-6 min-h-screen bg-gradient-to-br from-indigo-50 to-pink-50"},K={class:"p-8 space-y-6 w-full max-w-md bg-white rounded-3xl shadow-xl transition-all duration-300 hover:shadow-2xl"},Q={class:"text-3xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-purple-600"},W={key:0,class:"p-4 text-center text-green-700 bg-green-50 rounded-xl animate-fade-down"},X={class:"font-medium"},Y={key:1,class:"p-4 text-center text-red-700 bg-red-50 rounded-xl animate-fade-up"},ee={class:"font-medium"},re={key:2,class:"flex fixed inset-0 justify-center items-center px-4 bg-gradient-to-br from-rose-100 via-pink-50 to-white"},ae={class:"w-full max-w-md"},oe={class:"p-8 bg-white rounded-2xl shadow-xl"},se={class:"space-y-4"},de=N({__name:"VerifyEmailView",setup(te){const l=new H({position:{x:"center",y:"top"},duration:5e3,dismissible:!0}),a=t(!1),h=j(),o=h.query.mode,c=h.query.oobCode,g=$(),v=t(!1),_=t(!1),y=t(!1),s=t(!1),n=t(""),B=T(),M=async()=>{if(o!=="verifyEmail")throw s.value=!0,n.value='Invalid URL "Mode" parameter is not a valid value, does the URL have a valid "Mode" parameter?',new Error('URL has not a valid "Mode" parameter');if(!c)throw s.value=!0,n.value='Invalid URL "OOB" parameter is not a valid value, does the URL have a valid "OOB" parameter?',new Error('URL has not a valid "OOB" parameter');try{a.value=!0,await R(g,c),o==="verifyEmail"&&(v.value=!0),a.value=!1}catch(u){const e=u;console.log(e),s.value=!0,a.value=!1,n.value=e.code}};q({length:!1,uppercase:!1});const i=t(),f=t(),m=t(!1),V=async()=>{try{a.value=!0,await R(g,c),o==="verifyEmail"&&(v.value=!0,s.value=!1),a.value=!1}catch(u){const e=u;console.log(e),s.value=!0,v.value=!1,a.value=!1,n.value=e.code}},O=async()=>{if(!i.value){l.error("Por favor ingrese su nueva contraseña");return}if(i.value.length<8){l.error("La contraseña debe tener al menos 8 caracteres");return}if(!/[A-Z]/.test(i.value)){l.error("La contraseña debe tener al menos una letra mayúscula");return}if(i.value!==f.value){l.error("Las contraseñas no coinciden");return}if(!m.value){l.error("El código de verificación no es válido");return}try{a.value=!0,await Z(g,c,i.value),_.value=!0,y.value=!0,i.value="",f.value="",l.success("Contraseña actualizada correctamente, redirigiendo a iniciar sesión..."),B.push("/login"),a.value=!1}catch(u){const e=u;l.error(`Error al actualizar la contraseña: ${e.message}`),console.log(e),s.value=!0,a.value=!1,m.value=!1,y.value=!1,n.value=e.message}};return A(()=>{if(v.value=!1,s.value=!1,m.value=!1,n.value="",!o||!c){l.error('URL has not a valid "Mode" or "OOB" parameter'),s.value=!0,n.value='URL has not a valid "Mode" or "OOB" parameter';return}o==="verifyEmail"?M():o==="resetPassword"&&V()}),(u,e)=>{const U=S("RouterLink");return d(),k(G,null,{main:L(()=>[a.value?(d(),k(F,{key:0,class:"flex fixed inset-0 z-40 justify-center items-center bg-black/50"})):(d(),p("div",J,[r("div",K,[r("h1",Q," Verificar "+x(w(o)==="verifyEmail"?"correo":"contraseña"),1),v.value?(d(),p("div",W,[e[3]||(e[3]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto mb-2 w-8 h-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),r("p",X," ¡"+x(w(o)==="verifyEmail"?"Correo":"Contraseña")+" verificado con éxito! ",1),e[4]||(e[4]=r("p",{class:"mt-2 text-sm"},"Ahora puede iniciar sesión con su correo y contraseña.",-1)),e[5]||(e[5]=r("p",null,"¡Bienvenido a misreclamos.com!",-1)),z(U,{to:{name:"login"},class:"inline-flex items-center px-4 py-2 mt-4 text-white bg-indigo-600 rounded-lg transition-colors duration-200 hover:bg-indigo-700"},{default:L(()=>[...e[2]||(e[2]=[I(" Iniciar sesión",-1)])]),_:1})])):s.value||!m.value?(d(),p("div",Y,[e[6]||(e[6]=r("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto mb-2 w-8 h-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),r("p",ee," Error al verificar el "+x(w(o)==="verifyEmail"?"correo":"contraseña")+", código de error: "+x(n.value),1),e[7]||(e[7]=r("p",{class:"mt-2 text-sm"}," Por favor, verifique que los parámetros del enlace sean correctos. ",-1))])):E("",!0),w(o)==="resetPassword"&&!y.value?(d(),p("section",re,[r("div",ae,[r("div",oe,[e[10]||(e[10]=r("h2",{class:"mb-2 text-2xl font-bold text-center text-rose-600"}," Actualizar contraseña ",-1)),e[11]||(e[11]=r("p",{class:"mb-6 text-center text-gray-500"},"Por favor ingrese su nueva contraseña",-1)),r("form",se,[r("div",null,[e[8]||(e[8]=r("label",{for:"password",class:"block mb-1 text-sm font-medium text-gray-700"}," Nueva contraseña ",-1)),C(r("input",{"onUpdate:modelValue":e[0]||(e[0]=b=>i.value=b),type:"password",id:"password",class:"px-4 py-2 w-full rounded-xl border border-gray-300 transition focus:ring-2 focus:ring-rose-400 focus:border-rose-400",placeholder:"••••••••",required:""},null,512),[[P,i.value]])]),r("div",null,[e[9]||(e[9]=r("label",{for:"confirmPassword",class:"block mb-1 text-sm font-medium text-gray-700"}," Confirmar contraseña ",-1)),C(r("input",{"onUpdate:modelValue":e[1]||(e[1]=b=>f.value=b),type:"password",id:"confirmPassword",class:"px-4 py-2 w-full rounded-xl border border-gray-300 transition focus:ring-2 focus:ring-rose-400 focus:border-rose-400",placeholder:"••••••••",required:""},null,512),[[P,f.value]])]),r("button",{type:"submit",onClick:D(O,["prevent"]),class:"py-2.5 w-full font-semibold text-white bg-rose-500 rounded-xl shadow-md transition transform hover:bg-rose-600 hover:-translate-y-0.5"}," Guardar nueva contraseña ")])])])])):E("",!0)])]))]),_:1})}}});export{de as default};
